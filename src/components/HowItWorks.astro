---
import { getLocale } from 'astro-i18n-aut';
import { loadTranslations, t } from '../utils/i18n';
import type { Locale } from '../i18n/types';

const locale = getLocale(Astro.url) as Locale;
const translations = await loadTranslations(locale);
---

<section id="how-it-works" class="py-12 sm:py-20 px-4 sm:px-6 lg:px-8 bg-bhutan-primary">
	<div class="max-w-7xl mx-auto">
		<div class="text-center mb-12 sm:mb-16">
			<h2 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-4 text-bhutan-primary">
				{t('howItWorks.title', locale, translations)}
			</h2>
			<p class="text-lg sm:text-xl max-w-3xl mx-auto text-bhutan-secondary px-4">
				{t('howItWorks.subtitle', locale, translations)}
			</p>
		</div>

		<div class="relative pb-8 md:pb-0">
			<!-- Desktop Timeline line (centered) - starts and ends at step badges -->
			<div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 w-1" style="background-color: var(--border-light); top: 6rem; bottom: 6rem;"></div>
			
			<!-- Mobile Timeline line (left side) - starts and ends at step badges -->
			<div class="md:hidden absolute left-6 w-0.5" style="background-color: var(--border-light); top: 6rem; bottom: 6rem;"></div>

			<div class="space-y-8 sm:space-y-12 md:space-y-0">
				<!-- Step 1 -->
				<div class="relative flex flex-col md:flex-row items-start md:items-center md:min-h-[200px]">
					<!-- Mobile: Number badge on left with timeline -->
					<div class="md:hidden flex items-start mb-4">
						<div class="flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold text-white relative z-10 mr-4" style="background-color: var(--primary);">
							1
						</div>
						<div class="flex-1 pt-1">
							<h3 class="text-xl sm:text-2xl font-bold mb-2 sm:mb-3 text-bhutan-primary">{t('howItWorks.step1.title', locale, translations)}</h3>
							<p class="text-sm sm:text-base leading-relaxed text-bhutan-secondary">
								{t('howItWorks.step1.description', locale, translations)}
							</p>
						</div>
					</div>
					
					<!-- Desktop: Left side content -->
					<div class="hidden md:block md:w-1/2 md:pr-12 text-center md:text-right">
						<h3 class="text-2xl font-bold mb-3 text-bhutan-primary">{t('howItWorks.step1.title', locale, translations)}</h3>
						<p class="leading-relaxed text-bhutan-secondary">
							{t('howItWorks.step1.description', locale, translations)}
						</p>
					</div>
					
					<!-- Desktop: Number badge on timeline -->
					<div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 -translate-y-1/2 top-1/2 z-10">
						<div class="text-white w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold" style="background-color: var(--primary);">
							1
						</div>
					</div>
					
					<div class="hidden md:block md:w-1/2 md:pl-12"></div>
				</div>

				<!-- Step 2 -->
				<div class="relative flex flex-col md:flex-row items-start md:items-center md:min-h-[200px]">
					<!-- Mobile: Number badge on left with timeline -->
					<div class="md:hidden flex items-start mb-4">
						<div class="flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold text-white relative z-10 mr-4" style="background-color: var(--secondary);">
							2
						</div>
						<div class="flex-1 pt-1">
							<h3 class="text-xl sm:text-2xl font-bold mb-2 sm:mb-3 text-bhutan-primary">{t('howItWorks.step2.title', locale, translations)}</h3>
							<p class="text-sm sm:text-base leading-relaxed text-bhutan-secondary">
								{t('howItWorks.step2.description', locale, translations)}
							</p>
						</div>
					</div>
					
					<div class="hidden md:block md:w-1/2 md:pr-12"></div>
					
					<!-- Desktop: Number badge on timeline -->
					<div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 -translate-y-1/2 top-1/2 z-10">
						<div class="text-white w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold" style="background-color: var(--secondary);">
							2
						</div>
					</div>
					
					<!-- Desktop: Right side content -->
					<div class="hidden md:block md:w-1/2 md:pl-12 text-center md:text-left">
						<h3 class="text-2xl font-bold mb-3 text-bhutan-primary">{t('howItWorks.step2.title', locale, translations)}</h3>
						<p class="leading-relaxed text-bhutan-secondary">
							{t('howItWorks.step2.description', locale, translations)}
						</p>
					</div>
				</div>

				<!-- Step 3 -->
				<div class="relative flex flex-col md:flex-row items-start md:items-center md:min-h-[200px]">
					<!-- Mobile: Number badge on left with timeline -->
					<div class="md:hidden flex items-start mb-4">
						<div class="flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold text-white relative z-10 mr-4" style="background-color: var(--tertiary);">
							3
						</div>
						<div class="flex-1 pt-1">
							<h3 class="text-xl sm:text-2xl font-bold mb-2 sm:mb-3 text-bhutan-primary">{t('howItWorks.step3.title', locale, translations)}</h3>
							<p class="text-sm sm:text-base leading-relaxed text-bhutan-secondary">
								{t('howItWorks.step3.description', locale, translations)}
							</p>
						</div>
					</div>
					
					<!-- Desktop: Left side content -->
					<div class="hidden md:block md:w-1/2 md:pr-12 text-center md:text-right">
						<h3 class="text-2xl font-bold mb-3 text-bhutan-primary">{t('howItWorks.step3.title', locale, translations)}</h3>
						<p class="leading-relaxed text-bhutan-secondary">
							{t('howItWorks.step3.description', locale, translations)}
						</p>
					</div>
					
					<!-- Desktop: Number badge on timeline -->
					<div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 -translate-y-1/2 top-1/2 z-10">
						<div class="text-white w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold" style="background-color: var(--tertiary);">
							3
						</div>
					</div>
					
					<div class="hidden md:block md:w-1/2 md:pl-12"></div>
				</div>

				<!-- Step 4 -->
				<div class="relative flex flex-col md:flex-row items-start md:items-center md:min-h-[200px]">
					<!-- Mobile: Number badge on left with timeline -->
					<div class="md:hidden flex items-start mb-4">
						<div class="flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold text-white relative z-10 mr-4" style="background-color: var(--accent);">
							4
						</div>
						<div class="flex-1 pt-1">
							<h3 class="text-xl sm:text-2xl font-bold mb-2 sm:mb-3 text-bhutan-primary">{t('howItWorks.step4.title', locale, translations)}</h3>
							<p class="text-sm sm:text-base leading-relaxed text-bhutan-secondary">
								{t('howItWorks.step4.description', locale, translations)}
							</p>
						</div>
					</div>
					
					<div class="hidden md:block md:w-1/2 md:pr-12"></div>
					
					<!-- Desktop: Number badge on timeline -->
					<div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 -translate-y-1/2 top-1/2 z-10">
						<div class="text-white w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold" style="background-color: var(--accent);">
							4
						</div>
					</div>
					
					<!-- Desktop: Right side content -->
					<div class="hidden md:block md:w-1/2 md:pl-12 text-center md:text-left">
						<h3 class="text-2xl font-bold mb-3 text-bhutan-primary">{t('howItWorks.step4.title', locale, translations)}</h3>
						<p class="leading-relaxed text-bhutan-secondary">
							{t('howItWorks.step4.description', locale, translations)}
						</p>
					</div>
				</div>

				<!-- Step 5 - Last step, timeline ends here -->
				<div class="relative flex flex-col md:flex-row items-start md:items-center md:min-h-[200px]">
					<!-- Mobile: Number badge on left with timeline -->
					<div class="md:hidden flex items-start mb-4">
						<div class="flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center text-lg sm:text-xl font-bold text-white relative z-10 mr-4" style="background-color: var(--primary);">
							5
						</div>
						<div class="flex-1 pt-1">
							<h3 class="text-xl sm:text-2xl font-bold mb-2 sm:mb-3 text-bhutan-primary">{t('howItWorks.step5.title', locale, translations)}</h3>
							<p class="text-sm sm:text-base leading-relaxed text-bhutan-secondary">
								{t('howItWorks.step5.description', locale, translations)}
							</p>
						</div>
					</div>
					
					<!-- Desktop: Left side content -->
					<div class="hidden md:block md:w-1/2 md:pr-12 text-center md:text-right">
						<h3 class="text-2xl font-bold mb-3 text-bhutan-primary">{t('howItWorks.step5.title', locale, translations)}</h3>
						<p class="leading-relaxed text-bhutan-secondary">
							{t('howItWorks.step5.description', locale, translations)}
						</p>
					</div>
					
					<!-- Desktop: Number badge on timeline - last one, timeline ends here -->
					<div class="hidden md:block absolute left-1/2 transform -translate-x-1/2 -translate-y-1/2 top-1/2 z-10">
						<div class="text-white w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold" style="background-color: var(--primary);">
							5
						</div>
					</div>
					
					<div class="hidden md:block md:w-1/2 md:pl-12"></div>
				</div>
			</div>
		</div>
	</div>
</section>
